{
    "github": {
        "enabled": true,
        "token_env_var": "GITHUB_TOKEN",
        "collect_private_repos": true,
        "collect_archived_repos": false,
        "collect_forks": false,
        "organizations": [],
        "rate_limit_pause": 1,
        "max_retries": 3
    },
    "output": {
        "format": "json",
        "base_data": {
            "include_repository_metadata": true,
            "include_private_repositories": true,
            "include_repository_contents": true,
            "include_branch_information": true,
            "include_commit_history": true,
            "include_repository_statistics": true
        },
        "collaboration_data": {
            "include_collaborators": true,
            "include_teams": true,
            "include_outside_collaborators": true,
            "include_repository_permissions": true,
            "include_issues": true,
            "include_pull_requests": true,
            "include_issue_comments": true,
            "include_pr_reviews": true
        },
        "organization_data": {
            "include_organization_info": true,
            "include_organization_members": true,
            "include_organization_settings": true,
            "include_organization_teams": true,
            "include_organization_projects": true
        },
        "cicd_data": {
            "include_workflows": true,
            "include_workflow_runs": true,
            "include_workflow_jobs": true,
            "include_action_artifacts": true,
            "include_deployment_data": true,
            "include_environment_data": true
        },
        "security_data": {
            "include_security_data": true,
            "include_secret_scanning": true,
            "include_code_scanning": true,
            "include_vulnerability_alerts": true,
            "include_security_advisories": true,
            "include_dependency_data": true
        },
        "enterprise_data": {
            "include_audit_logs": true,
            "include_enterprise_settings": true,
            "include_scim_data": true,
            "include_network_configurations": true,
            "include_copilot_usage": true
        },
        "package_data": {
            "include_packages": true,
            "include_package_versions": true,
            "include_package_dependencies": true
        },
        "advanced_features": {
            "include_discussions": true,
            "include_projects": true,
            "include_github_pages": true,
            "include_releases": true,
            "include_tags": true,
            "include_webhooks": true
        },
        "output_options": {
            "include_raw_api_responses": false,
            "include_rate_limit_info": true,
            "include_collection_timestamp": true,
            "include_token_permissions": true,
            "group_by_organization": true,
            "separate_security_report": true
        }
    },
    "permissions": {
        "description": "Comprehensive list of GitHub API permissions for fine-grained tokens",
        "last_updated": "2025-01-31",
        "repository_permissions": {
            "administration": {
                "description": "Manage repository settings, webhooks, and collaborators",
                "access_levels": [
                    "read",
                    "write"
                ],
                "endpoints": [
                    "Repository settings",
                    "Collaborator management",
                    "Branch protection rules",
                    "Repository webhooks"
                ],
                "required_for": [
                    "Repository management",
                    "Security configuration"
                ]
            },
            "contents": {
                "description": "Read and write repository files and directories",
                "access_levels": [
                    "read",
                    "write"
                ],
                "endpoints": [
                    "Repository contents",
                    "File operations",
                    "Directory listings",
                    "File commits"
                ],
                "required_for": [
                    "Code access",
                    "File management",
                    "Content modification"
                ]
            },
            "metadata": {
                "description": "Access repository metadata (always included)",
                "access_levels": [
                    "read"
                ],
                "endpoints": [
                    "Repository information",
                    "Basic repository data",
                    "Repository statistics"
                ],
                "required_for": [
                    "Basic repository information"
                ]
            },
            "actions": {
                "description": "GitHub Actions workflows, runs, and artifacts",
                "access_levels": [
                    "read",
                    "write"
                ],
                "endpoints": [
                    "Workflow files",
                    "Workflow runs",
                    "Workflow jobs",
                    "Action artifacts",
                    "Action secrets",
                    "Action variables"
                ],
                "required_for": [
                    "CI/CD monitoring",
                    "Workflow management"
                ]
            },
            "issues": {
                "description": "Repository issues and related data",
                "access_levels": [
                    "read",
                    "write"
                ],
                "endpoints": [
                    "Issues",
                    "Issue comments",
                    "Issue labels",
                    "Issue milestones",
                    "Issue assignees"
                ],
                "required_for": [
                    "Issue tracking",
                    "Project management"
                ]
            },
            "pull_requests": {
                "description": "Pull requests and reviews",
                "access_levels": [
                    "read",
                    "write"
                ],
                "endpoints": [
                    "Pull requests",
                    "PR reviews",
                    "PR comments",
                    "Review requests"
                ],
                "required_for": [
                    "Code review process",
                    "Collaboration"
                ]
            },
            "security_events": {
                "description": "Security alerts and events",
                "access_levels": [
                    "read",
                    "write"
                ],
                "endpoints": [
                    "Security advisories",
                    "Vulnerability alerts",
                    "Security events"
                ],
                "required_for": [
                    "Security monitoring",
                    "Vulnerability management"
                ]
            },
            "secret_scanning_alerts": {
                "description": "Secret scanning alerts and status",
                "access_levels": [
                    "read",
                    "write"
                ],
                "endpoints": [
                    "Secret scanning alerts",
                    "Secret scanning status"
                ],
                "required_for": [
                    "Secret security",
                    "Compliance scanning"
                ]
            },
            "vulnerability_alerts": {
                "description": "Dependabot vulnerability alerts",
                "access_levels": [
                    "read",
                    "write"
                ],
                "endpoints": [
                    "Dependabot alerts",
                    "Dependency vulnerabilities"
                ],
                "required_for": [
                    "Dependency security",
                    "Vulnerability tracking"
                ]
            },
            "code_scanning_alerts": {
                "description": "Code scanning and analysis alerts",
                "access_levels": [
                    "read",
                    "write"
                ],
                "endpoints": [
                    "Code scanning alerts",
                    "SARIF uploads",
                    "Code analysis results"
                ],
                "required_for": [
                    "Code security analysis",
                    "SAST results"
                ]
            },
            "commit_statuses": {
                "description": "Commit status checks and context",
                "access_levels": [
                    "read",
                    "write"
                ],
                "endpoints": [
                    "Commit statuses",
                    "Status checks",
                    "Combined status"
                ],
                "required_for": [
                    "CI/CD status",
                    "Branch protection"
                ]
            },
            "deployments": {
                "description": "Repository deployments and environments",
                "access_levels": [
                    "read",
                    "write"
                ],
                "endpoints": [
                    "Deployments",
                    "Deployment statuses",
                    "Environments",
                    "Protection rules"
                ],
                "required_for": [
                    "Deployment tracking",
                    "Environment management"
                ]
            },
            "pages": {
                "description": "GitHub Pages configuration and builds",
                "access_levels": [
                    "read",
                    "write"
                ],
                "endpoints": [
                    "Pages configuration",
                    "Pages builds",
                    "Pages deployment"
                ],
                "required_for": [
                    "Static site management",
                    "Pages deployment"
                ]
            },
            "checks": {
                "description": "Check runs and check suites",
                "access_levels": [
                    "read",
                    "write"
                ],
                "endpoints": [
                    "Check runs",
                    "Check suites",
                    "Check annotations"
                ],
                "required_for": [
                    "Custom checks",
                    "CI integrations"
                ]
            },
            "custom_properties": {
                "description": "Repository custom properties",
                "access_levels": [
                    "read",
                    "write"
                ],
                "endpoints": [
                    "Custom properties",
                    "Property values"
                ],
                "required_for": [
                    "Metadata management",
                    "Repository classification"
                ]
            }
        },
        "organization_permissions": {
            "members": {
                "description": "Organization members and membership",
                "access_levels": [
                    "read",
                    "write"
                ],
                "endpoints": [
                    "Organization members",
                    "Membership status",
                    "Public members"
                ],
                "required_for": [
                    "Member management",
                    "Access control"
                ]
            },
            "administration": {
                "description": "Organization settings and configuration",
                "access_levels": [
                    "read",
                    "write"
                ],
                "endpoints": [
                    "Organization settings",
                    "Organization webhooks",
                    "Organization secrets"
                ],
                "required_for": [
                    "Organization management",
                    "Settings control"
                ]
            },
            "team_discussions": {
                "description": "Team discussions and comments",
                "access_levels": [
                    "read",
                    "write"
                ],
                "endpoints": [
                    "Team discussions",
                    "Discussion comments"
                ],
                "required_for": [
                    "Team communication",
                    "Internal discussions"
                ]
            },
            "security_events": {
                "description": "Organization security events and alerts",
                "access_levels": [
                    "read",
                    "write"
                ],
                "endpoints": [
                    "Organization security events",
                    "Security advisories"
                ],
                "required_for": [
                    "Organization security",
                    "Audit trails"
                ]
            },
            "custom_properties": {
                "description": "Organization custom properties",
                "access_levels": [
                    "read",
                    "write"
                ],
                "endpoints": [
                    "Organization custom properties",
                    "Property definitions"
                ],
                "required_for": [
                    "Organization metadata",
                    "Classification systems"
                ]
            },
            "custom_roles": {
                "description": "Organization custom repository roles",
                "access_levels": [
                    "read",
                    "write"
                ],
                "endpoints": [
                    "Custom repository roles",
                    "Role assignments"
                ],
                "required_for": [
                    "Access control",
                    "Permission management"
                ]
            },
            "personal_access_tokens": {
                "description": "Fine-grained personal access token management",
                "access_levels": [
                    "read",
                    "write"
                ],
                "endpoints": [
                    "PAT requests",
                    "PAT approvals"
                ],
                "required_for": [
                    "Token governance",
                    "Access auditing"
                ]
            }
        },
        "account_permissions": {
            "profile": {
                "description": "User profile information",
                "access_levels": [
                    "read",
                    "write"
                ],
                "endpoints": [
                    "User profile",
                    "Public profile data"
                ],
                "required_for": [
                    "User identification",
                    "Profile management"
                ]
            },
            "email_addresses": {
                "description": "User email addresses",
                "access_levels": [
                    "read",
                    "write"
                ],
                "endpoints": [
                    "Email addresses",
                    "Primary email",
                    "Email visibility"
                ],
                "required_for": [
                    "Contact information",
                    "Notifications"
                ]
            },
            "followers": {
                "description": "User followers and following",
                "access_levels": [
                    "read",
                    "write"
                ],
                "endpoints": [
                    "Followers list",
                    "Following list",
                    "Follow/unfollow actions"
                ],
                "required_for": [
                    "Social features",
                    "Network analysis"
                ]
            },
            "ssh_signing_keys": {
                "description": "SSH signing keys for commit verification",
                "access_levels": [
                    "read",
                    "write"
                ],
                "endpoints": [
                    "SSH signing keys",
                    "Key management"
                ],
                "required_for": [
                    "Commit signing",
                    "Security verification"
                ]
            },
            "gpg_keys": {
                "description": "GPG keys for commit and tag signing",
                "access_levels": [
                    "read",
                    "write"
                ],
                "endpoints": [
                    "GPG keys",
                    "Key verification"
                ],
                "required_for": [
                    "Commit verification",
                    "Security signing"
                ]
            }
        },
        "current_token_permissions": {
            "note": "Updated based on classic token analysis - 17 scopes, access to 16 repos and kovr-ai org",
            "token_type": "classic",
            "token_scopes": [
                "audit_log",
                "copilot", 
                "notifications",
                "read:discussion",
                "read:enterprise",
                "read:gpg_key",
                "read:network_configurations",
                "read:org",
                "read:packages",
                "read:project",
                "read:public_key",
                "read:repo_hook",
                "read:ssh_signing_key",
                "read:user",
                "repo",
                "scim:enterprise",
                "workflow"
            ],
            "repository_permissions": {
                "contents": "read/write",
                "metadata": "read",
                "issues": "read/write",
                "pull_requests": "read/write",
                "actions": "read/write",
                "administration": "read",
                "collaborators": "read",
                "deployments": "read",
                "commit_statuses": "read/write",
                "repository_hooks": "read"
            },
            "organization_permissions": {
                "members": "read",
                "administration": "read",
                "projects": "read",
                "team_discussions": "read"
            },
            "account_permissions": {
                "profile": "read",
                "email_addresses": "read",
                "gpg_keys": "read",
                "ssh_signing_keys": "read",
                "public_keys": "read"
            },
            "enterprise_permissions": {
                "audit_logs": "read",
                "enterprise_settings": "read",
                "scim_provisioning": "read",
                "network_configurations": "read"
            },
            "special_access": {
                "copilot_usage": "read",
                "packages": "read",
                "discussions": "read",
                "notifications": "read/write"
            },
            "current_access": {
                "repositories": "16 total (3 public, 13 private)",
                "organizations": "1 (kovr-ai)",
                "collaborators": "14 accessible",
                "workflows": "5 accessible",
                "rate_limit": "5000/hour"
            },
            "remaining_limitations": [
                "May need admin permissions for some security features",
                "Secret scanning may require repository admin access",
                "Code scanning alerts may require security manager role",
                "Some enterprise features may require enterprise admin role"
            ]
        },
        "recommended_permissions_for_kovr": {
            "basic_collection": {
                "repository_permissions": {
                    "contents": "read",
                    "metadata": "read",
                    "issues": "read",
                    "pull_requests": "read",
                    "actions": "read",
                    "administration": "read"
                },
                "use_case": "Basic repository data collection"
            },
            "security_collection": {
                "repository_permissions": {
                    "contents": "read",
                    "metadata": "read",
                    "security_events": "read",
                    "secret_scanning_alerts": "read",
                    "vulnerability_alerts": "read",
                    "code_scanning_alerts": "read",
                    "administration": "read"
                },
                "use_case": "Comprehensive security scanning"
            },
            "compliance_collection": {
                "repository_permissions": {
                    "contents": "read",
                    "metadata": "read",
                    "administration": "read",
                    "security_events": "read",
                    "secret_scanning_alerts": "read",
                    "vulnerability_alerts": "read",
                    "code_scanning_alerts": "read",
                    "actions": "read",
                    "deployments": "read"
                },
                "organization_permissions": {
                    "members": "read",
                    "administration": "read",
                    "security_events": "read"
                },
                "use_case": "Full compliance and governance scanning"
            }
        }
    }
}
