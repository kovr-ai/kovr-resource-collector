system_compatible_checks:
  SystemEnrichedCheck:
    # Base check fields (inherits from benchmark Check)
    unique_id: string             # Global unique ID format: "OWASP-2021-A01-001"
    name: string                  # Short descriptive name
    literature: string            # Original targeted literature

    # Benchmark mapping results (from Section 1)
    controls[]: string            # Mapped controls: ["NIST-800-53-AC-3"]
    frameworks[]: string          # Mapped frameworks: ["NIST-800-53", "ISO-27001"]
    benchmark_mapping[]: string   # Existing benchmark IDs if any
    mapping_confidence: float     # Confidence score for mappings (0.0-1.0)
    category: string              # Check category
    severity: string              # Risk severity level
    tags[]: string               # Classification tags
    extracted_at: datetime
    mapped_at: datetime
    
    # Section 2: System compatibility fields
    resource_type: string         # Compatible resource type: "GitHub::Repo", "AWS::EC2"
    field_paths_used[]: string    # Actual field paths: ["repo.basic_info.branches[].protected"]
    targeted_guidance: string     # System-specific actionable guidance
    system_enriched_at: datetime  # When system enrichment was performed
    
    # Resource selection results
    valid_resources[]:
      - "system_compatible_checks.ResourceSchema"    # Resources that are valid for this check
    invalid_resources[]:
      - "system_compatible_checks.ResourceSchema"    # Resources that are not valid for this check

  SystemCompatibilityCoverage:
    # Basic counts
    total_checks: int
    checks_with_resource_types: int
    checks_with_field_paths: int
    checks_with_targeted_guidance: int
    
    # Coverage percentages
    coverage_percentages:
      resource_types: float       # % of checks with valid resource types assigned
      field_paths: float          # % of checks with valid field paths populated  
      targeted_guidance: float    # % of checks with fully generated targeted guidance
      
    # Provider breakdown
    provider_coverage:
      github_checks: int
      aws_checks: int
      google_checks: int
      multi_provider_checks: int
      
    # Quality metrics
    quality_metrics:
      avg_field_paths_per_check: float
      avg_guidance_length: float
      checks_with_multiple_resources: int

  ResourceSchema:
    resource_name: string         # Resource name: "GitHubResource"
    field_paths[]: string         # Available field paths for this resource
    provider: string              # System provider: "github", "aws", "google"
    literature: string           # Resource type description
    reason: string                # Reason why Resource type is valid/invalid for this check