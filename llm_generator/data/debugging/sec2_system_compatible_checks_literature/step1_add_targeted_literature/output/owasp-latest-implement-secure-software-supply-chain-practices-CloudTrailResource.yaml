resource:
  check:
    unique_id: owasp-latest-implement-secure-software-supply-chain-practices
  field_paths:
  - trails
  - trails[].enable_log_file_validation
  - trails[].event_selectors
  - trails[].event_selectors[].data_resources
  - trails[].event_selectors[].data_resources.type
  - trails[].event_selectors[].data_resources.values
  - trails[].event_selectors[].data_resources.values[]
  - trails[].event_selectors[].include_management_events
  - trails[].event_selectors[].read_write_type
  - trails[].id
  - trails[].include_global_service_events
  - trails[].insight_selectors
  - trails[].insight_selectors[].insight_type
  - trails[].is_logging
  - trails[].is_multi_region_trail
  - trails[].kms_key_id
  - trails[].log_file_validation_enabled
  - trails[].name
  - trails[].s3_bucket_name
  - trails[].s3_key_prefix
  - trails[].tags
  - trails[].tags[].key
  - trails[].tags[].value
  fix_details:
    automation_available: true
    description: To fully implement secure software supply chain practices using AWS
      CloudTrail, ensure that CloudTrail is configured to log relevant events, and
      the logs are stored in a secure and immutable location.
    estimated_time: 1-2 hours
    instructions:
    - 1. Review the CloudTrail trail configuration and ensure that relevant event
      selectors are enabled to capture events related to software deployments, infrastructure
      changes, and other critical operations.
    - 2. Configure CloudTrail to log management events and global service events,
      if applicable to your environment.
    - 3. Enable log file validation to ensure the integrity of the CloudTrail logs.
    - 4. Store the CloudTrail logs in an S3 bucket with appropriate access controls
      and versioning enabled to prevent accidental or unauthorized modifications.
    - 5. Consider encrypting the CloudTrail logs using AWS KMS for additional security.
    - 6. Implement monitoring and alerting mechanisms to detect and respond to potential
      threats or unauthorized activities captured in the CloudTrail logs.
  is_valid: true
  literature: AWS CloudTrail is a service that records AWS API calls and related events,
    providing a comprehensive audit trail of activities across your AWS account. By
    configuring CloudTrail to log relevant events and storing the logs in a secure
    and immutable location, organizations can implement secure software supply chain
    practices by monitoring and auditing activities related to their software deployments
    and infrastructure changes. This allows for the detection of unauthorized or malicious
    actions, enabling organizations to respond promptly and mitigate potential threats
    to their software supply chain.
  name: CloudTrailResource
  output_statements:
    failure: CloudTrail is not configured to log relevant events, or the logs are
      not stored in a secure and immutable location, hindering the implementation
      of secure software supply chain practices.
    partial: CloudTrail is partially configured to log relevant events, but additional
      configuration or improvements may be required to fully implement secure software
      supply chain practices.
    success: CloudTrail is configured to log relevant events, and the logs are stored
      in a secure and immutable location, enabling secure software supply chain practices.
  reason: AWS CloudTrail provides comprehensive logging and monitoring capabilities
    that can be leveraged to implement secure software supply chain practices. By
    configuring CloudTrail to log relevant events, organizations can audit and monitor
    activities related to their software deployments, infrastructure changes, and
    other critical operations, enabling them to detect and respond to potential threats
    or unauthorized actions.
