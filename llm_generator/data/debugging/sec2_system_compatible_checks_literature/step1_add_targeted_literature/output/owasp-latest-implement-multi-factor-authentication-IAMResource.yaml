resource:
  check:
    unique_id: owasp-latest-implement-multi-factor-authentication
  field_paths:
  - users
  - users[]
  - users[].mfa_devices
  - users[].mfa_devices[]
  - users[].mfa_devices[].enable_date
  - users[].mfa_devices[].serial_number
  - users[].mfa_devices[].type
  - users[].mfa_devices[].virtual_mfa_token
  fix_details:
    automation_available: true
    description: For any IAM users without MFA enabled, you need to set up and enforce
      MFA for their accounts.
    estimated_time: 30 minutes to 1 hour
    instructions:
    - Identify IAM users without MFA enabled by checking the 'users[].mfa_devices'
      field path.
    - For each user without MFA, follow AWS documentation to set up a virtual or hardware
      MFA device.
    - Update your IAM policies to require MFA for all user accounts and privileged
      actions.
    - Regularly review and audit IAM user accounts to ensure MFA compliance.
  is_valid: true
  literature: The IAMResource in AWS is applicable for implementing multi-factor authentication
    (MFA) as it contains information about IAM users and their associated MFA devices.
    By analyzing the 'users' and 'users[].mfa_devices' field paths, you can determine
    which users have MFA enabled and enforce MFA for all user accounts.
  name: IAMResource
  output_statements:
    failure: One or more IAM users do not have multi-factor authentication (MFA) enabled,
      increasing the risk of unauthorized access.
    partial: Some IAM users have multi-factor authentication (MFA) enabled, but not
      all. Ensure MFA is enforced for all user accounts.
    success: All IAM users have multi-factor authentication (MFA) enabled, ensuring
      an additional layer of security beyond just a password.
  reason: The IAMResource contains the necessary information to identify IAM users
    and their associated MFA devices, which is essential for implementing and enforcing
    multi-factor authentication.
