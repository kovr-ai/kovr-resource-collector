resource:
  check:
    unique_id: owasp-latest-enforce-least-privileges
  field_paths:
  - event_selectors
  - event_selectors[].data_resources
  - event_selectors[].data_resources.type
  - event_selectors[].data_resources.values
  - event_selectors[].data_resources.values[]
  - event_selectors[].include_management_events
  - event_selectors[].read_write_type
  - trails[].event_selectors
  - trails[].event_selectors[].data_resources
  - trails[].event_selectors[].data_resources.type
  - trails[].event_selectors[].data_resources.values
  - trails[].event_selectors[].data_resources.values[]
  - trails[].event_selectors[].include_management_events
  - trails[].event_selectors[].read_write_type
  fix_details:
    automation_available: true
    description: If CloudTrail is not configured correctly, you need to update the
      event selectors and data resource filters to enforce least privilege access.
    estimated_time: 30 minutes to 1 hour
    instructions:
    - Review the current CloudTrail trail configurations and identify any unnecessary
      or overly permissive event selectors or data resource filters.
    - Update the event selectors to include only the necessary management and data
      events required for your use case.
    - Configure data resource filters to restrict access to only the required AWS
      resources and services.
    - Test and validate the updated CloudTrail configuration to ensure it logs the
      appropriate events and access.
    - Monitor CloudTrail logs regularly to identify and address any potential privilege
      escalation or unauthorized access.
  is_valid: true
  literature: The AWS CloudTrail resource is applicable for implementing the 'owasp-latest-enforce-least-privileges'
    security check. CloudTrail logs all API activity across AWS accounts and services,
    allowing you to monitor and analyze user and resource activity. By configuring
    CloudTrail trails with appropriate event selectors and data resource filters,
    you can enforce least privilege by auditing and restricting access to only necessary
    resources and actions.
  name: CloudTrailResource
  output_statements:
    failure: CloudTrail is not configured with appropriate event selectors and data
      resource filters to enforce least privilege access to resources and actions.
    partial: CloudTrail is partially configured with appropriate event selectors and
      data resource filters to enforce least privilege access to resources and actions.
    success: CloudTrail is configured with appropriate event selectors and data resource
      filters to enforce least privilege access to resources and actions.
  reason: The CloudTrail resource allows you to configure event selectors and data
    resource filters to log and monitor specific API activities and resource access.
    This enables you to enforce least privilege by auditing and restricting access
    to only necessary resources and actions, aligning with the 'owasp-latest-enforce-least-privileges'
    security check.
