resource:
  check:
    unique_id: owasp-latest-enforce-least-privilege-principles
  field_paths:
  - event_selectors
  - event_selectors[]
  - event_selectors[].data_resources
  - event_selectors[].data_resources.type
  - event_selectors[].data_resources.values
  - event_selectors[].data_resources.values[]
  - event_selectors[].include_management_events
  - event_selectors[].read_write_type
  - trails
  - trails[]
  - trails[].event_selectors
  - trails[].event_selectors[]
  - trails[].event_selectors[].data_resources
  - trails[].event_selectors[].data_resources.type
  - trails[].event_selectors[].data_resources.values
  - trails[].event_selectors[].data_resources.values[]
  - trails[].event_selectors[].include_management_events
  - trails[].event_selectors[].read_write_type
  fix_details:
    automation_available: true
    description: If CloudTrail is not properly configured, you need to update the
      event selectors and data resource filters to log and monitor access to specific
      AWS resources and services.
    estimated_time: 30 minutes to 1 hour
    instructions:
    - 1. Review the current CloudTrail trail configurations and identify any missing
      or overly permissive event selectors or data resource filters.
    - 2. Update the event selectors to include only the necessary read/write events
      and management events for your use case.
    - 3. Configure data resource filters to specify the exact AWS resources and services
      that should be monitored.
    - 4. Ensure that the CloudTrail trail is logging to an S3 bucket and enabling
      log file validation for integrity.
    - 5. Regularly review CloudTrail logs and investigate any suspicious or unauthorized
      access attempts.
  is_valid: true
  literature: The AWS CloudTrail resource is applicable for implementing the 'owasp-latest-enforce-least-privilege-principles'
    security check. CloudTrail logs all API calls made within an AWS account, allowing
    you to monitor and analyze user and service activity. By configuring CloudTrail
    trails with appropriate event selectors and data resource filters, you can enforce
    least privilege principles by logging and auditing access to specific AWS resources
    and services. This enables you to identify and remediate any excessive permissions
    or unauthorized access attempts.
  name: CloudTrailResource
  output_statements:
    failure: CloudTrail is not configured with appropriate event selectors and data
      resource filters to enforce least privilege principles.
    partial: CloudTrail is partially configured with event selectors and data resource
      filters, but additional configuration is required to fully enforce least privilege
      principles.
    success: CloudTrail is configured with appropriate event selectors and data resource
      filters to enforce least privilege principles.
  reason: CloudTrail allows you to log and monitor access to specific AWS resources
    and services, which is essential for enforcing least privilege principles. By
    configuring event selectors and data resource filters, you can ensure that only
    necessary access is granted and logged.
