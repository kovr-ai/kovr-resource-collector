resource:
  check:
    unique_id: owasp-latest-validate-access-controls-on-the-server-side
  field_paths:
  - event_selectors
  - event_selectors[]
  - event_selectors[].data_resources
  - event_selectors[].data_resources.type
  - event_selectors[].data_resources.values
  - event_selectors[].data_resources.values[]
  - event_selectors[].include_management_events
  - event_selectors[].read_write_type
  - trails
  - trails[]
  - trails[].event_selectors
  - trails[].event_selectors[]
  - trails[].event_selectors[].data_resources
  - trails[].event_selectors[].data_resources.type
  - trails[].event_selectors[].data_resources.values
  - trails[].event_selectors[].data_resources.values[]
  - trails[].event_selectors[].include_management_events
  - trails[].event_selectors[].read_write_type
  fix_details:
    automation_available: true
    description: If CloudTrail trails and event selectors are not properly configured
      to capture and analyze access control-related events, remediation steps are
      required.
    estimated_time: 30 minutes to 1 hour
    instructions:
    - Review the existing CloudTrail trails and event selectors to identify any gaps
      in capturing access control-related events.
    - Configure event selectors to include relevant data resources and management
      events related to access control.
    - Ensure that the read_write_type parameter is set to capture both read and write
      events.
    - Enable log file validation and configure appropriate log retention policies.
    - Set up monitoring and alerting mechanisms to detect and respond to potential
      access control violations.
  is_valid: true
  literature: The 'owasp-latest-validate-access-controls-on-the-server-side' check
    is designed to validate that access controls are properly implemented on the server-side
    of an application. AWS CloudTrail is a service that records AWS API calls and
    related events, which can be used to monitor and audit access to AWS resources.
    By configuring CloudTrail trails and event selectors, you can capture and analyze
    API activity to ensure that access controls are properly enforced and that only
    authorized entities can perform specific actions on protected resources.
  name: CloudTrailResource
  output_statements:
    failure: CloudTrail trails and event selectors are not configured to capture and
      analyze access control-related events, preventing proper validation of server-side
      access controls.
    partial: CloudTrail trails and event selectors are partially configured to capture
      and analyze access control-related events, but additional configuration may
      be required to fully validate server-side access controls.
    success: CloudTrail trails and event selectors are configured to capture and analyze
      access control-related events, allowing for proper validation of server-side
      access controls.
  reason: The CloudTrail resource is applicable for implementing the 'owasp-latest-validate-access-controls-on-the-server-side'
    check because it allows you to capture and analyze API activity, including access
    control-related events, across AWS resources. By configuring CloudTrail trails
    and event selectors, you can monitor and audit access to ensure that access controls
    are properly enforced.
