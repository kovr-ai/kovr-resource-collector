resource:
  check:
    unique_id: owasp-latest-implement-comprehensive-monitoring-mechanisms
  field_paths:
  - event_selectors
  - event_selectors[]
  - event_selectors[].data_resources
  - event_selectors[].data_resources.type
  - event_selectors[].data_resources.values
  - event_selectors[].data_resources.values[]
  - event_selectors[].include_management_events
  - event_selectors[].read_write_type
  - trails
  - trails[]
  - trails[].enable_log_file_validation
  - trails[].event_selectors
  - trails[].event_selectors[]
  - trails[].event_selectors[].data_resources
  - trails[].event_selectors[].data_resources.type
  - trails[].event_selectors[].data_resources.values
  - trails[].event_selectors[].data_resources.values[]
  - trails[].event_selectors[].include_management_events
  - trails[].event_selectors[].read_write_type
  - trails[].include_global_service_events
  - trails[].is_logging
  - trails[].is_multi_region_trail
  - trails[].log_file_validation_enabled
  - trails[].s3_bucket_name
  - trails[].s3_key_prefix
  fix_details:
    automation_available: true
    description: To fully implement comprehensive monitoring mechanisms using CloudTrail,
      ensure that all relevant AWS services and resources are covered by CloudTrail
      trails, with appropriate event selectors and log file validation enabled.
    estimated_time: 1-2 hours
    instructions:
    - Review the existing CloudTrail trails and event selectors to identify any gaps
      in coverage for critical AWS services and resources.
    - Create new CloudTrail trails or update existing ones to include event selectors
      that capture API activities for the missing services and resources.
    - Enable log file validation for all CloudTrail trails to ensure the integrity
      and completeness of log files.
    - Configure CloudTrail to deliver log files to a secure and centralized location
      (e.g., S3 bucket) for long-term retention and analysis.
    - Implement automated monitoring and alerting mechanisms to detect and respond
      to potential security incidents based on CloudTrail log data.
  is_valid: true
  literature: The AWS CloudTrail resource is a key component for implementing comprehensive
    monitoring mechanisms as recommended by the OWASP security check. CloudTrail captures
    API activity across AWS services and resources, providing a detailed audit trail
    of user actions, resource changes, and security events. By configuring CloudTrail
    trails with appropriate event selectors and log file validation, organizations
    can monitor and log critical activities, enabling detection of unauthorized access
    attempts, data breaches, and potential security incidents.
  name: CloudTrailResource
  output_statements:
    failure: CloudTrail is not configured properly to capture and log API activities,
      leaving the organization vulnerable to undetected security incidents and unauthorized
      access attempts.
    partial: CloudTrail is partially configured to capture and log API activities,
      but some critical events or resources may not be monitored, potentially leaving
      gaps in the organization's security monitoring capabilities.
    success: CloudTrail is configured to capture and log API activities across AWS
      services and resources, enabling comprehensive monitoring and detection of potential
      security incidents.
  reason: The CloudTrail resource provides comprehensive logging and monitoring capabilities
    for AWS API activities, which aligns with the OWASP security check's recommendation
    for implementing robust monitoring mechanisms to detect security incidents and
    unauthorized access attempts.
