resource:
  check:
    unique_id: owasp-latest-implement-proper-access-control-mechanisms
  field_paths:
  - trails[].event_selectors
  - trails[].event_selectors[].data_resources
  - trails[].event_selectors[].data_resources.type
  - trails[].event_selectors[].data_resources.values
  - trails[].event_selectors[].data_resources.values[]
  - trails[].event_selectors[].include_management_events
  - trails[].event_selectors[].read_write_type
  - trails[].is_logging
  - trails[].is_multi_region_trail
  - trails[].log_file_validation_enabled
  fix_details:
    automation_available: true
    description: If CloudTrail is not configured properly, it may not log all relevant
      events and activities, making it difficult to monitor and audit access control
      mechanisms effectively.
    estimated_time: 30 minutes to 1 hour
    instructions:
    - Review the CloudTrail trail configuration and ensure that relevant event selectors
      and data resources are enabled for logging.
    - Enable log file validation to ensure the integrity of CloudTrail logs.
    - Configure CloudTrail to log management events and read/write events as needed.
    - Consider enabling multi-region trails to capture events across multiple AWS
      regions.
    - Regularly review CloudTrail logs and set up alerts for suspicious activities
      or policy violations.
  is_valid: true
  literature: AWS CloudTrail is a service that records AWS API calls and related events
    for your account. It provides a log of activities that can be used to implement
    proper access control mechanisms by monitoring and auditing user actions and API
    calls. CloudTrail logs can be analyzed to identify unauthorized access attempts,
    policy violations, or suspicious activities, enabling organizations to take appropriate
    actions to enforce access control policies and protect sensitive resources.
  name: CloudTrailResource
  output_statements:
    failure: CloudTrail is not configured to log relevant events and activities, hindering
      the ability to monitor and audit access control mechanisms effectively.
    partial: CloudTrail is partially configured to log relevant events and activities,
      but additional configuration may be required to fully monitor and audit access
      control mechanisms.
    success: CloudTrail is configured to log relevant events and activities, enabling
      proper monitoring and auditing of access control mechanisms.
  reason: CloudTrail logs can be used to monitor and audit user activities, API calls,
    and resource access, which is essential for implementing proper access control
    mechanisms. By analyzing CloudTrail logs, organizations can identify unauthorized
    access attempts, policy violations, or suspicious activities, and take appropriate
    actions to enforce access control policies and protect sensitive resources.
