resource:
  check:
    unique_id: owasp-latest-use-secure-defaults
  field_paths:
  - trails[].enable_log_file_validation
  - trails[].event_selectors
  - trails[].event_selectors[].data_resources
  - trails[].event_selectors[].include_management_events
  - trails[].event_selectors[].read_write_type
  - trails[].include_global_service_events
  - trails[].insight_selectors
  - trails[].is_logging
  - trails[].is_multi_region_trail
  - trails[].log_file_validation_enabled
  - trails[].s3_bucket_name
  - trails[].s3_key_prefix
  fix_details:
    automation_available: true
    description: If CloudTrail is not configured with secure defaults, several settings
      need to be adjusted to ensure comprehensive event logging and secure storage.
    estimated_time: 30 minutes
    instructions:
    - Enable log file validation to ensure log file integrity
    - Configure event selectors to capture all relevant API events, including management
      events and read/write operations
    - Include global service events to capture activities across all AWS services
    - Set up a secure S3 bucket with appropriate access controls and encryption for
      log storage
    - Configure a specific S3 key prefix for better organization and access control
  is_valid: true
  literature: The CloudTrail resource in AWS is applicable for implementing the 'owasp-latest-use-secure-defaults'
    security check. CloudTrail is a service that records AWS API calls and related
    events, providing a log of account activity. By configuring CloudTrail with secure
    defaults, organizations can ensure that all relevant events are captured, logged,
    and monitored for potential security incidents or unauthorized activities. This
    helps maintain system integrity and supports compliance with security standards
    like NIST 800-53 and ISO 27001.
  name: CloudTrailResource
  output_statements:
    failure: CloudTrail is not configured with secure defaults, potentially missing
      critical API events or logging to an insecure location.
    partial: CloudTrail is partially configured with secure defaults, but some settings
      may need to be adjusted to ensure comprehensive event logging and secure storage.
    success: CloudTrail is configured with secure defaults, capturing all relevant
      API events and logging them to a secure S3 bucket.
  reason: The CloudTrail resource provides various configuration options that align
    with the 'owasp-latest-use-secure-defaults' check. By enabling log file validation,
    configuring event selectors, including management events, and setting up secure
    S3 bucket and prefix settings, organizations can ensure that CloudTrail captures
    and logs all relevant API activities, supporting system integrity and secure defaults.
