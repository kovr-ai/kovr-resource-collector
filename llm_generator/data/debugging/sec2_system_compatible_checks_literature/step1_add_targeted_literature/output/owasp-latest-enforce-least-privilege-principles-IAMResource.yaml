resource:
  check:
    unique_id: owasp-latest-enforce-least-privilege-principles
  field_paths:
  - policies
  - policies[].default_version.Document.Statement
  - policies[].default_version.Document.Statement[].Action
  - policies[].default_version.Document.Statement[].Resource
  - users
  - users[].access_keys
  fix_details:
    automation_available: true
    description: If the check fails, you need to review and update the IAM policies
      and user access keys to remove any unnecessary permissions or privileges.
    estimated_time: 30 minutes to 2 hours, depending on the number of policies and
      users
    instructions:
    - Identify the specific IAM policies and user access keys that grant excessive
      permissions.
    - Review the policy statements, allowed actions, and assigned resources to determine
      the minimum required privileges.
    - Update the policies and user access keys to remove any unnecessary permissions
      or privileges.
    - Implement a regular review process to ensure least privilege principles are
      continuously enforced.
  is_valid: true
  literature: The IAMResource in AWS is highly relevant for implementing the 'owasp-latest-enforce-least-privilege-principles'
    security check. This resource contains information about AWS Identity and Access
    Management (IAM) policies and user access keys, which are critical components
    for enforcing the principle of least privilege. By analyzing the policies and
    user permissions, you can ensure that users, processes, and services operate with
    the minimum necessary privileges required to perform their intended tasks, and
    no more.
  name: IAMResource
  output_statements:
    failure: One or more IAM policies or user access keys violate the principle of
      least privilege by granting excessive permissions.
    partial: N/A
    success: All IAM policies and user access keys adhere to the principle of least
      privilege. Users and services operate with the minimum required permissions.
  reason: The IAMResource provides access to IAM policies and user access keys, which
    are essential for evaluating and enforcing least privilege principles. By inspecting
    the policy statements, allowed actions, and assigned resources, you can determine
    if users and services have excessive permissions. Additionally, analyzing user
    access keys can help identify potential misuse or unauthorized access.
