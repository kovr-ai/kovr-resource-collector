resource:
  check:
    unique_id: owasp-latest-use-secure-communication-protocols-(e.g.,-https)
  field_paths:
  - buckets[].encryption.enabled
  - buckets[].encryption.type
  - buckets[].encryption.kms_key_id
  - buckets[].public_access_block.block_public_acls
  - buckets[].public_access_block.block_public_policy
  - buckets[].public_access_block.ignore_public_acls
  - buckets[].public_access_block.restrict_public_buckets
  fix_details:
    automation_available: true
    description: 'For S3 buckets that do not have encryption enabled or have public
      access allowed, the following steps should be taken to align with the OWASP
      recommendation:'
    estimated_time: 15-30 minutes per bucket
    instructions:
    - Enable encryption for the S3 bucket using either AWS-managed keys (SSE-S3) or
      customer-managed keys (SSE-KMS).
    - Configure the S3 bucket's public access block settings to block public access
      control lists (ACLs), block public bucket policies, ignore public ACLs, and
      restrict public bucket access.
    - Review and remove any existing public access policies or ACLs that grant public
      access to the bucket or its objects.
  is_valid: true
  literature: The OWASP check 'Use Secure Communication Protocols (e.g., HTTPS)' is
    primarily focused on ensuring that web applications and services communicate over
    secure protocols like HTTPS. However, for AWS S3 buckets, the relevant security
    aspect is ensuring that data at rest is encrypted and that public access is restricted.
    While S3 buckets do not directly handle communication protocols, implementing
    encryption and access controls aligns with the broader principle of protecting
    data from unauthorized access and tampering.
  name: S3Resource
  output_statements:
    failure: One or more S3 buckets do not have encryption enabled or have public
      access allowed, which increases the risk of unauthorized access and data tampering,
      violating the OWASP recommendation to use secure communication protocols.
    partial: Some S3 buckets have encryption enabled and public access restricted,
      while others do not, partially aligning with the OWASP recommendation to use
      secure communication protocols.
    success: The S3 bucket(s) have encryption enabled, and public access is appropriately
      restricted, aligning with the OWASP recommendation to use secure communication
      protocols.
  reason: While S3 buckets do not directly handle communication protocols, ensuring
    that data at rest is encrypted and public access is restricted aligns with the
    broader principle of protecting data from unauthorized access and tampering, which
    is the intent of the OWASP check.
