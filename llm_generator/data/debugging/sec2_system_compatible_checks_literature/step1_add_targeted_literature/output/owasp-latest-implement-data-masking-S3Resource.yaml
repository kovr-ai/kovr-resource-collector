resource:
  check:
    unique_id: owasp-latest-implement-data-masking
  field_paths:
  - buckets
  - buckets[].encryption
  - buckets[].encryption.enabled
  - buckets[].encryption.kms_key_id
  - buckets[].encryption.type
  - buckets[].public_access_block
  - buckets[].public_access_block.block_public_acls
  - buckets[].public_access_block.block_public_policy
  - buckets[].public_access_block.ignore_public_acls
  - buckets[].public_access_block.restrict_public_buckets
  fix_details:
    automation_available: true
    description: Ensure all S3 buckets have server-side encryption enabled (SSE-S3
      or SSE-KMS) and appropriate access controls (public access block, bucket policies)
      to protect sensitive data.
    estimated_time: 30 minutes to 1 hour per bucket, depending on the number of buckets
      and existing configurations.
    instructions:
    - 1. Review all S3 buckets and identify those without encryption or with insecure
      access controls.
    - 2. For buckets without encryption, enable server-side encryption using either
      SSE-S3 or SSE-KMS with a customer-managed key.
    - 3. For buckets with insecure access controls, configure the public access block
      to restrict public access and review/update bucket policies to allow access
      only to authorized users/roles.
    - 4. Monitor and regularly review S3 bucket configurations to ensure ongoing compliance
      with data masking requirements.
  is_valid: true
  literature: The AWS S3 service provides data encryption capabilities that can be
    used to implement data masking and protect sensitive information stored in S3
    buckets. By enabling server-side encryption (SSE) with either AWS-managed keys
    (SSE-S3) or customer-managed keys (SSE-KMS), S3 automatically encrypts data at
    rest, effectively masking the original data. Additionally, S3 bucket policies
    and access controls can be configured to restrict access to authorized users/roles,
    further enhancing data protection.
  name: S3Resource
  output_statements:
    failure: One or more S3 buckets are not configured with encryption or have insecure
      access controls, potentially exposing sensitive data.
    partial: Some S3 buckets are configured with encryption and access controls, but
      others may be exposing sensitive data.
    success: S3 buckets are configured with encryption and appropriate access controls
      to mask sensitive data.
  reason: The S3Resource provides encryption and access control capabilities that
    can be used to implement data masking and protect sensitive data stored in S3
    buckets.
