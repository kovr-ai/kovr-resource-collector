resource:
  check:
    unique_id: owasp-latest-log-security-relevant-events
  field_paths:
  - event_selectors
  - event_selectors[]
  - event_selectors[].data_resources
  - event_selectors[].data_resources.type
  - event_selectors[].data_resources.values
  - event_selectors[].data_resources.values[]
  - event_selectors[].include_management_events
  - event_selectors[].read_write_type
  - trails
  - trails[]
  - trails[].event_selectors
  - trails[].event_selectors[]
  - trails[].event_selectors[].data_resources
  - trails[].event_selectors[].data_resources.type
  - trails[].event_selectors[].data_resources.values
  - trails[].event_selectors[].data_resources.values[]
  - trails[].event_selectors[].include_management_events
  - trails[].event_selectors[].read_write_type
  - trails[].is_logging
  - trails[].log_file_validation_enabled
  fix_details:
    automation_available: true
    description: If CloudTrail is not properly configured to log security-relevant
      events or if log file validation is disabled, you need to update the CloudTrail
      trail settings.
    estimated_time: 15 minutes
    instructions:
    - 1. Open the AWS CloudTrail console and navigate to the 'Trails' section.
    - 2. Select the trail you want to update, or create a new trail if necessary.
    - 3. In the 'Event selectors' section, ensure that the appropriate data resources
      and event types are selected to capture security-relevant events, including
      management events and read/write operations.
    - 4. Enable 'Log file validation' to ensure the integrity of the logs.
    - 5. Review and apply the changes to the trail configuration.
  is_valid: true
  literature: The AWS CloudTrail resource is directly applicable for implementing
    the 'owasp-latest-log-security-relevant-events' security check. CloudTrail is
    a service that records AWS API calls and related events, providing a comprehensive
    audit trail of activities across your AWS account. By configuring CloudTrail to
    log security-relevant events, you can meet the requirements of this check and
    maintain a detailed record of security-related activities for incident response,
    forensic analysis, and compliance purposes.
  name: CloudTrailResource
  output_statements:
    failure: CloudTrail is not configured to log security-relevant events, or log
      file validation is disabled.
    partial: CloudTrail is partially configured to log security-relevant events, but
      some settings may be missing or misconfigured.
    success: CloudTrail is configured to log security-relevant events, including management
      events and read/write operations, with log file validation enabled.
  reason: The CloudTrail resource allows you to configure event selectors and data
    resources to capture specific security-relevant events, including management events
    and read/write operations. Additionally, you can enable log file validation to
    ensure the integrity of the logs. These features directly align with the requirements
    of the 'owasp-latest-log-security-relevant-events' check, making CloudTrail a
    valid resource for implementing this security control.
