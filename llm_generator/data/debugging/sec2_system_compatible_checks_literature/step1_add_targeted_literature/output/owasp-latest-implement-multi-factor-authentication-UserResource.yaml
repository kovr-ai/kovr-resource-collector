resource:
  check:
    unique_id: owasp-latest-implement-multi-factor-authentication
  field_paths:
  - security_info.isEnrolledIn2Sv
  - security_info.isEnforcedIn2Sv
  fix_details:
    automation_available: true
    description: If MFA is not implemented or enforced, you need to enable and enforce
      Google's Two-Step Verification for the user account.
    estimated_time: 10 minutes
    instructions:
    - 1. Navigate to the Google Admin console and select the user account.
    - 2. Under 'Account > Security', enable 'Enforcing 2-Step Verification'.
    - 3. Follow the prompts to enroll the user in 2-Step Verification.
    - 4. Verify that security_info.isEnrolledIn2Sv and security_info.isEnforcedIn2Sv
      are both true for the user.
  is_valid: true
  literature: The UserResource in Google Cloud represents a user account within an
    organization. To implement multi-factor authentication (MFA) for this resource,
    you need to leverage the security_info fields. The security_info.isEnrolledIn2Sv
    field indicates whether the user is enrolled in Google's Two-Step Verification
    (2SV), which is their implementation of MFA. The security_info.isEnforcedIn2Sv
    field shows if 2SV is enforced for that user account.
  name: UserResource
  output_statements:
    failure: Multi-factor authentication is not implemented or enforced for the user
      account.
    partial: Multi-factor authentication is implemented but not enforced for the user
      account.
    success: Multi-factor authentication is implemented and enforced for the user
      account.
  reason: The UserResource contains fields specifically related to multi-factor authentication
    enrollment and enforcement, making it applicable for this security check.
