resource:
  check:
    unique_id: owasp-latest-enforce-least-privileges
  field_paths:
  - instances[].iam_instance_profile
  - instances[].iam_instance_profile.Arn
  - instances[].iam_instance_profile.Id
  - security_groups
  - security_groups.inbound_rules
  - security_groups.inbound_rules[].cidr
  - security_groups.inbound_rules[].from_port
  - security_groups.inbound_rules[].to_port
  - security_groups.outbound_rules
  - security_groups.outbound_rules[].cidr
  - security_groups.outbound_rules[].from_port
  - security_groups.outbound_rules[].to_port
  fix_details:
    automation_available: true
    description: To address any issues related to the principle of least privilege,
      you need to review and adjust the permissions and access controls for EC2 instances
      and security groups.
    estimated_time: 1-2 hours
    instructions:
    - 1. Review the IAM roles and policies associated with each EC2 instance and remove
      any unnecessary permissions.
    - 2. Analyze the security group rules (inbound and outbound) and restrict access
      to only the required ports and IP addresses.
    - 3. Implement least privileged access controls within your applications and systems
      running on the EC2 instances.
    - 4. Regularly review and audit access rights to ensure they remain aligned with
      the principle of least privilege.
  is_valid: false
  literature: The 'owasp-latest-enforce-least-privileges' security check focuses on
    ensuring that applications and systems follow the principle of least privilege,
    which restricts access rights to only the essential permissions required for intended
    functions. This helps mitigate threats like privilege escalation, unauthorized
    data access, and malicious code execution.
  name: EC2Resource
  output_statements:
    failure: One or more EC2 instances or security groups have excessive privileges
      or overly permissive access rules, violating the principle of least privilege.
    partial: Some EC2 instances and security groups adhere to the principle of least
      privilege, but others have excessive privileges or overly permissive access
      rules.
    success: The EC2 instances and security groups follow the principle of least privilege,
      with access rights restricted to only essential permissions.
  reason: The EC2Resource does not directly relate to enforcing least privilege principles
    for applications and systems. While it provides information about EC2 instances,
    security groups, and network configurations, it does not cover the specific access
    controls, permissions, and privilege management aspects required for this security
    check.
