resource:
  check:
    unique_id: owasp-latest-enforce-least-privileges
  field_paths:
  - admin_info.isAdmin
  - admin_info.isDelegatedAdmin
  - basic_info.ipWhitelisted
  - organizational_info.orgUnitPath
  - security_info.isEnforcedIn2Sv
  - security_info.isEnrolledIn2Sv
  fix_details:
    automation_available: true
    description: If the user has been granted excessive privileges or access rights,
      these should be reviewed and revoked or restricted as necessary.
    estimated_time: 30 minutes to 1 hour
    instructions:
    - Review the user's administrative privileges (admin_info.isAdmin, admin_info.isDelegatedAdmin)
      and ensure they are only granted to users who require these elevated permissions.
    - Verify the user's IP whitelisting status (basic_info.ipWhitelisted) and remove
      any unnecessary whitelisting.
    - Analyze the user's organizational unit path (organizational_info.orgUnitPath)
      and ensure they are placed in the appropriate organizational unit based on their
      role and access requirements.
    - Check the user's two-factor authentication enrollment status (security_info.isEnforcedIn2Sv,
      security_info.isEnrolledIn2Sv) and enforce two-factor authentication for users
      with elevated privileges or access to sensitive data.
    - Regularly review and audit user privileges and access rights to ensure they
      align with the principle of least privilege.
  is_valid: true
  literature: The 'owasp-latest-enforce-least-privileges' check aims to ensure that
    the Google User resource follows the principle of least privilege by granting
    only the necessary permissions required for the user's intended functions. This
    mitigates risks like unauthorized data access, privilege escalation, and malicious
    code execution. To implement this check, the relevant field paths should be analyzed
    to determine if the user has excessive privileges or access rights.
  name: UserResource
  output_statements:
    failure: The user has been granted excessive privileges or access rights that
      are not essential for their intended functions.
    partial: Some aspects of the user's privileges and access rights adhere to the
      principle of least privilege, but other areas require further review.
    success: The user has been granted the minimum required privileges and access
      rights based on their intended functions.
  reason: The Google User resource contains fields that can indicate the user's administrative
    privileges, IP whitelisting status, organizational unit path, and two-factor authentication
    enrollment, which are relevant for assessing whether the user has more access
    than necessary.
