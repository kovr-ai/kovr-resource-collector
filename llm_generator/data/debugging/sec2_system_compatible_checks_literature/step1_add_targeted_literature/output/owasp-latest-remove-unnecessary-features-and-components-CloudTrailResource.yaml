resource:
  check:
    unique_id: owasp-latest-remove-unnecessary-features-and-components
  field_paths:
  - event_selectors
  - event_selectors[]
  - event_selectors[].data_resources
  - event_selectors[].data_resources.type
  - event_selectors[].data_resources.values
  - event_selectors[].data_resources.values[]
  - event_selectors[].include_management_events
  - event_selectors[].read_write_type
  - trails
  - trails[]
  - trails[].event_selectors
  - trails[].event_selectors[]
  - trails[].event_selectors[].data_resources
  - trails[].event_selectors[].data_resources.type
  - trails[].event_selectors[].data_resources.values
  - trails[].event_selectors[].data_resources.values[]
  - trails[].event_selectors[].include_management_events
  - trails[].event_selectors[].read_write_type
  fix_details:
    automation_available: true
    description: Review the CloudTrail event selectors and data resources to ensure
      that only necessary events and resources are being logged.
    estimated_time: 30 minutes
    instructions:
    - 1. Open the AWS CloudTrail console and navigate to the 'Trails' section.
    - 2. Select the trail you want to modify and click on the 'Edit' button.
    - 3. Review the 'Data events' and 'Management events' sections, and ensure that
      only necessary events and resources are selected.
    - 4. Remove any unnecessary event selectors or data resources that are not required
      for your use case.
    - 5. Save the changes to the trail configuration.
  is_valid: true
  literature: The AWS CloudTrail resource is applicable for implementing the OWASP
    check 'owasp-latest-remove-unnecessary-features-and-components'. CloudTrail is
    a service that records AWS API calls and related events, providing a log of activities
    across your AWS infrastructure. By configuring CloudTrail appropriately, you can
    ensure that only necessary events and resources are logged, reducing the attack
    surface and minimizing the exposure of sensitive data or unnecessary components.
  name: CloudTrailResource
  output_statements:
    failure: CloudTrail is configured to log unnecessary events and resources, increasing
      the attack surface and exposing unnecessary features and components.
    partial: CloudTrail is partially configured to log only necessary events and resources,
      but some unnecessary components may still be exposed.
    success: CloudTrail is configured to log only necessary events and resources,
      minimizing the exposure of unnecessary features and components.
  reason: The CloudTrail resource allows you to configure event selectors and data
    resources to control which events and resources are logged. By carefully configuring
    these settings, you can ensure that only necessary events and resources are captured,
    reducing the attack surface and minimizing the exposure of unnecessary components
    or features.
