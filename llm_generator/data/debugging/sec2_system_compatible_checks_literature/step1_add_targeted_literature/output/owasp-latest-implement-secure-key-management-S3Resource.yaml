resource:
  check:
    unique_id: owasp-latest-implement-secure-key-management
  field_paths:
  - buckets[].encryption
  - buckets[].encryption.enabled
  - buckets[].encryption.kms_key_id
  - buckets[].encryption.type
  fix_details:
    automation_available: true
    description: Enable encryption for all S3 buckets using a customer-managed KMS
      key to ensure secure key management practices.
    estimated_time: 30 minutes to 1 hour
    instructions:
    - Identify S3 buckets without encryption or using an insecure encryption method/key.
    - Create a new customer-managed KMS key or use an existing one.
    - Update the bucket encryption configuration to enable encryption using the customer-managed
      KMS key.
    - Monitor and rotate the KMS key periodically as per your organization's security
      policies.
  is_valid: true
  literature: The AWS S3 resource is applicable for implementing secure key management
    practices as per the OWASP security check. S3 buckets support server-side encryption
    using AWS Key Management Service (KMS) keys or Amazon S3 managed keys. Enabling
    encryption and using a customer-managed KMS key allows for secure key management
    and rotation.
  name: S3Resource
  output_statements:
    failure: One or more S3 buckets do not have encryption enabled or are using an
      insecure encryption method/key. Secure key management practices are not being
      followed.
    partial: Some S3 buckets have encryption enabled using a customer-managed KMS
      key, while others do not. Secure key management practices are partially implemented.
    success: The S3 bucket(s) have encryption enabled using a customer-managed KMS
      key, ensuring secure key management practices.
  reason: The S3 resource provides fields to configure encryption and specify a KMS
    key for each bucket. This allows implementing secure key management practices
    such as using strong encryption algorithms, properly generating and storing keys,
    and regularly rotating keys.
