resource:
  check:
    unique_id: owasp-latest-conduct-penetration-testing
  field_paths:
  - event_selectors
  - event_selectors[]
  - event_selectors[].data_resources
  - event_selectors[].data_resources.type
  - event_selectors[].data_resources.values
  - event_selectors[].data_resources.values[]
  - event_selectors[].include_management_events
  - event_selectors[].read_write_type
  - trails
  - trails[]
  - trails[].event_selectors
  - trails[].event_selectors[]
  - trails[].event_selectors[].data_resources
  - trails[].event_selectors[].data_resources.type
  - trails[].event_selectors[].data_resources.values
  - trails[].event_selectors[].data_resources.values[]
  - trails[].event_selectors[].include_management_events
  - trails[].event_selectors[].read_write_type
  - trails[].is_logging
  - trails[].is_multi_region_trail
  - trails[].log_file_validation_enabled
  fix_details:
    automation_available: true
    description: Ensure CloudTrail is properly configured to log all relevant events
      and resources for your AWS environment.
    estimated_time: 30 minutes to 1 hour
    instructions:
    - Review the current CloudTrail event selectors and data resource filters to identify
      any gaps or missing configurations.
    - Update the event selectors to include all necessary management events, read/write
      operations, and data resources relevant to your penetration testing scope.
    - Enable log file validation and configure multi-region trails if required for
      your environment.
    - Verify that CloudTrail is logging to an appropriate S3 bucket with proper access
      controls and retention policies.
  is_valid: true
  literature: AWS CloudTrail is a service that records AWS API calls and related events
    for your account. It provides a comprehensive audit trail of all activities across
    your AWS infrastructure, which can be invaluable for conducting penetration testing
    and identifying potential security vulnerabilities. By analyzing CloudTrail logs,
    security teams can simulate attack scenarios, identify misconfigurations, and
    assess the effectiveness of security controls. CloudTrail's event selectors and
    data resource filters allow you to customize the types of events and resources
    to log, enabling targeted penetration testing efforts.
  name: CloudTrailResource
  output_statements:
    failure: CloudTrail is not configured to log necessary events and resources, hindering
      the ability to conduct comprehensive penetration testing and security assessments.
    partial: CloudTrail is partially configured to log relevant events and resources,
      but additional configuration may be required for comprehensive penetration testing
      and security assessments.
    success: CloudTrail is configured to log relevant events and resources, enabling
      effective penetration testing and security assessments.
  reason: AWS CloudTrail provides detailed logging and auditing capabilities that
    are essential for conducting comprehensive penetration testing and identifying
    potential security vulnerabilities across AWS resources and services. By configuring
    CloudTrail event selectors and data resource filters, security teams can capture
    relevant API activity and simulate various attack scenarios to assess the effectiveness
    of security controls.
