resource:
  check:
    unique_id: owasp-latest-implement-secure-configuration-management-processes
  field_paths:
  - trails
  - trails[].enable_log_file_validation
  - trails[].event_selectors
  - trails[].event_selectors[].data_resources
  - trails[].event_selectors[].data_resources.type
  - trails[].event_selectors[].data_resources.values
  - trails[].event_selectors[].data_resources.values[]
  - trails[].event_selectors[].include_management_events
  - trails[].event_selectors[].read_write_type
  - trails[].include_global_service_events
  - trails[].insight_selectors
  - trails[].insight_selectors[].insight_type
  - trails[].is_logging
  - trails[].is_multi_region_trail
  - trails[].log_file_validation_enabled
  - trails[].s3_bucket_name
  - trails[].s3_key_prefix
  fix_details:
    automation_available: true
    description: 'To ensure CloudTrail is configured correctly for secure configuration
      management processes, the following steps should be taken:'
    estimated_time: 30 minutes to 1 hour
    instructions:
    - Enable CloudTrail and ensure it is logging all API calls and related events
      for your AWS account.
    - Configure CloudTrail to log management events and global service events.
    - Enable log file validation to ensure the integrity of CloudTrail logs.
    - Configure CloudTrail to send logs to an S3 bucket for long-term storage and
      analysis.
    - Review and adjust the event selectors and data resources to ensure all relevant
      resources and events are being logged.
    - Consider enabling CloudTrail Insights for additional monitoring and analysis
      capabilities.
  is_valid: true
  literature: AWS CloudTrail is a service that records AWS API calls and related events,
    providing a comprehensive audit trail of account activity. By enabling CloudTrail
    and configuring it correctly, organizations can implement secure configuration
    management processes by tracking and monitoring changes made to their AWS resources.
    CloudTrail logs can be analyzed to identify unauthorized or unintended changes,
    and the logs can be used as evidence for compliance audits and investigations.
  name: CloudTrailResource
  output_statements:
    failure: CloudTrail is not configured correctly to support secure configuration
      management processes. Changes to AWS resources may not be properly tracked and
      monitored.
    partial: CloudTrail is partially configured to support secure configuration management
      processes, but some settings may need to be adjusted to ensure comprehensive
      tracking and monitoring of changes.
    success: CloudTrail is configured correctly to support secure configuration management
      processes by tracking and monitoring changes made to AWS resources.
  reason: AWS CloudTrail provides a comprehensive audit trail of account activity,
    including API calls and related events, which is essential for implementing secure
    configuration management processes. By configuring CloudTrail correctly, organizations
    can track and monitor changes made to their AWS resources, identify unauthorized
    or unintended changes, and use the logs for compliance audits and investigations.
