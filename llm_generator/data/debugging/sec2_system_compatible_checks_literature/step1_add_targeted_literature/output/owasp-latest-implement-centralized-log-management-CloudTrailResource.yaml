resource:
  check:
    unique_id: owasp-latest-implement-centralized-log-management
  field_paths:
  - trails
  - trails[].is_logging
  - trails[].s3_bucket_name
  - trails[].event_selectors
  - trails[].event_selectors[].data_resources
  - trails[].event_selectors[].include_management_events
  - trails[].log_file_validation_enabled
  - trails[].is_multi_region_trail
  fix_details:
    automation_available: true
    description: If CloudTrail is not configured correctly, it may not capture all
      necessary logs or deliver them to a centralized location, hindering log management
      and security monitoring.
    estimated_time: 30 minutes to 1 hour
    instructions:
    - 1. Review the existing CloudTrail trails and ensure they cover all relevant
      AWS services and regions.
    - 2. Configure event selectors to capture the desired types of events, including
      management events and data events.
    - 3. Set up an Amazon S3 bucket to receive and store CloudTrail logs.
    - 4. Enable log file validation to ensure log integrity.
    - 5. Consider enabling multi-region trails to capture events from multiple regions
      in a single trail.
    - 6. Review and update CloudTrail configurations regularly to ensure comprehensive
      log coverage.
  is_valid: true
  literature: AWS CloudTrail is a service that enables centralized log management
    by recording AWS API calls and related events across multiple AWS services and
    regions. It provides a comprehensive audit trail of account activity, which can
    be analyzed to detect potential security incidents, troubleshoot operational issues,
    and comply with regulatory requirements. CloudTrail logs can be delivered to an
    Amazon S3 bucket for long-term storage and analysis.
  name: CloudTrailResource
  output_statements:
    failure: CloudTrail is not configured correctly to capture and centralize logs
      from all relevant AWS services and regions, hindering effective log management
      and security monitoring.
    partial: CloudTrail is partially configured to capture and centralize logs, but
      some services or regions may not be covered, potentially impacting log management
      and security monitoring.
    success: CloudTrail is configured to capture and centralize logs from all relevant
      AWS services and regions, enabling effective log management and security monitoring.
  reason: AWS CloudTrail is a service specifically designed for centralized log management,
    capturing API activity across multiple AWS services and regions. By configuring
    CloudTrail trails and event selectors, organizations can collect and store logs
    in a centralized S3 bucket for analysis and auditing purposes.
