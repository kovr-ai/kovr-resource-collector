resource:
  check:
    unique_id: owasp-latest-implement-secure-logging-mechanisms
  field_paths:
  - trails[].enable_log_file_validation
  - trails[].event_selectors
  - trails[].event_selectors[].data_resources
  - trails[].event_selectors[].include_management_events
  - trails[].event_selectors[].read_write_type
  - trails[].is_logging
  - trails[].is_multi_region_trail
  - trails[].kms_key_id
  - trails[].log_file_validation_enabled
  - trails[].s3_bucket_name
  - trails[].s3_key_prefix
  fix_details:
    automation_available: true
    description: 'If CloudTrail is not configured correctly, follow these steps to
      implement secure logging mechanisms:'
    estimated_time: 30 minutes
    instructions:
    - 1. Enable CloudTrail and configure it to capture all management and data events
      across all AWS regions.
    - 2. Configure CloudTrail to use an AWS KMS key for encrypting log files at rest.
    - 3. Enable log file validation to ensure log file integrity.
    - 4. Create a dedicated S3 bucket with appropriate access controls to store CloudTrail
      logs.
    - 5. Configure CloudTrail to deliver logs to the secure S3 bucket.
    - 6. Set up Amazon CloudWatch Logs to monitor and analyze CloudTrail logs.
  is_valid: true
  literature: AWS CloudTrail is a service that enables secure logging of account activity
    related to actions across the AWS infrastructure. It records API calls for AWS
    services and captures relevant details about each activity, including the identity
    of the API caller, the time of the event, the source IP address, and more. CloudTrail
    logs can be delivered to an Amazon S3 bucket for long-term durability and analysis.
    Implementing CloudTrail with appropriate configurations helps meet the secure
    logging requirements outlined in the OWASP security check.
  name: CloudTrailResource
  output_statements:
    failure: CloudTrail is not configured correctly to capture and securely store
      account activity logs.
    partial: CloudTrail is partially configured to capture and store account activity
      logs, but some security best practices are not implemented.
    success: CloudTrail is configured to capture relevant account activity logs, validate
      log file integrity, encrypt logs with KMS, and deliver logs to a secure S3 bucket.
  reason: AWS CloudTrail provides comprehensive logging capabilities for capturing
    and storing account activity logs, which aligns with the secure logging requirements
    outlined in the OWASP security check. The relevant field paths allow configuring
    CloudTrail to capture desired event types, enable log file validation, encrypt
    logs with KMS, and deliver logs to a secure S3 bucket.
