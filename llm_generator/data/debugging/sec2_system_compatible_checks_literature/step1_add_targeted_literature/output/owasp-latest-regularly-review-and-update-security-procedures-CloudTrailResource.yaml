resource:
  check:
    unique_id: owasp-latest-regularly-review-and-update-security-procedures
  field_paths:
  - trails
  - trails[].event_selectors
  - trails[].event_selectors[].data_resources
  - trails[].event_selectors[].include_management_events
  - trails[].event_selectors[].read_write_type
  - trails[].is_logging
  - trails[].is_multi_region_trail
  - trails[].log_file_validation_enabled
  fix_details:
    automation_available: true
    description: Ensure that CloudTrail is properly configured to capture relevant
      events and that logs are regularly reviewed to identify potential security issues
      and update security procedures.
    estimated_time: 1 hour
    instructions:
    - 1. Enable CloudTrail and configure event selectors to capture relevant API calls
      and events.
    - 2. Configure CloudTrail to log events across all regions (multi-region trail).
    - 3. Enable log file validation to ensure log integrity.
    - 4. Establish a process for regularly reviewing CloudTrail logs (e.g., daily,
      weekly) to identify potential security issues or policy violations.
    - 5. Based on the log review, update security procedures and policies to address
      identified issues and align with best practices.
  is_valid: true
  literature: AWS CloudTrail is a service that records AWS API calls and related events,
    providing a comprehensive audit trail of account activity. By enabling CloudTrail
    and configuring it to capture relevant events, organizations can regularly review
    and analyze the logs to identify potential security issues, detect unauthorized
    access attempts, and monitor compliance with security policies and procedures.
    Regular review of CloudTrail logs is a crucial step in maintaining an effective
    security posture and identifying areas for improvement or updates to security
    procedures.
  name: CloudTrailResource
  output_statements:
    failure: CloudTrail is not configured to capture relevant events, or logs are
      not regularly reviewed to identify potential security issues and update security
      procedures.
    partial: CloudTrail is partially configured to capture relevant events, but logs
      may not be regularly reviewed to identify potential security issues and update
      security procedures.
    success: CloudTrail is configured to capture relevant events, and logs are regularly
      reviewed to identify potential security issues and update security procedures
      accordingly.
  reason: AWS CloudTrail provides a comprehensive audit trail of account activity,
    which can be used to regularly review and update security procedures based on
    the logged events and identified security issues or policy violations.
