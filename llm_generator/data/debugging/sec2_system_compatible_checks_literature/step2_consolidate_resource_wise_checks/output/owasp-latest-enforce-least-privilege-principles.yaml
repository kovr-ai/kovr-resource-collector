check:
  invalid_resources: []
  unique_id: owasp-latest-enforce-least-privilege-principles
  valid_resources:
  - field_paths:
    - policies
    - policies[].default_version.Document.Statement
    - policies[].default_version.Document.Statement[].Action
    - policies[].default_version.Document.Statement[].Resource
    - users
    - users[].access_keys
    literature: The IAMResource in AWS is highly relevant for implementing the 'owasp-latest-enforce-least-privilege-principles'
      security check. This resource contains information about AWS Identity and Access
      Management (IAM) policies and user access keys, which are critical components
      for enforcing the principle of least privilege. By analyzing the policies and
      user permissions, you can ensure that users, processes, and services operate
      with the minimum necessary privileges required to perform their intended tasks,
      and no more.
    name: IAMResource
    reason: The IAMResource provides access to IAM policies and user access keys,
      which are essential for evaluating and enforcing least privilege principles.
      By inspecting the policy statements, allowed actions, and assigned resources,
      you can determine if users and services have excessive permissions. Additionally,
      analyzing user access keys can help identify potential misuse or unauthorized
      access.
  - field_paths:
    - buckets[].public_access_block
    - buckets[].public_access_block.block_public_acls
    - buckets[].public_access_block.block_public_policy
    - buckets[].public_access_block.ignore_public_acls
    - buckets[].public_access_block.restrict_public_buckets
    - buckets[].encryption
    - buckets[].encryption.enabled
    - buckets[].encryption.type
    literature: The AWS S3 resource is applicable for implementing the 'owasp-latest-enforce-least-privilege-principles'
      security check. S3 buckets can be configured with various access controls and
      permissions to enforce the principle of least privilege. By properly configuring
      bucket policies, access control lists (ACLs), and other security settings, you
      can restrict access to only authorized users, roles, or services, and limit
      the actions they can perform on the bucket and its objects.
    name: S3Resource
    reason: The S3 resource provides various configuration options and settings that
      allow you to implement the principle of least privilege by controlling access
      to buckets and objects, enabling encryption, and restricting public access.
      The relevant field paths cover these security controls.
  - field_paths:
    - event_selectors
    - event_selectors[]
    - event_selectors[].data_resources
    - event_selectors[].data_resources.type
    - event_selectors[].data_resources.values
    - event_selectors[].data_resources.values[]
    - event_selectors[].include_management_events
    - event_selectors[].read_write_type
    - trails
    - trails[]
    - trails[].event_selectors
    - trails[].event_selectors[]
    - trails[].event_selectors[].data_resources
    - trails[].event_selectors[].data_resources.type
    - trails[].event_selectors[].data_resources.values
    - trails[].event_selectors[].data_resources.values[]
    - trails[].event_selectors[].include_management_events
    - trails[].event_selectors[].read_write_type
    literature: The AWS CloudTrail resource is applicable for implementing the 'owasp-latest-enforce-least-privilege-principles'
      security check. CloudTrail logs all API calls made within an AWS account, allowing
      you to monitor and analyze user and service activity. By configuring CloudTrail
      trails with appropriate event selectors and data resource filters, you can enforce
      least privilege principles by logging and auditing access to specific AWS resources
      and services. This enables you to identify and remediate any excessive permissions
      or unauthorized access attempts.
    name: CloudTrailResource
    reason: CloudTrail allows you to log and monitor access to specific AWS resources
      and services, which is essential for enforcing least privilege principles. By
      configuring event selectors and data resource filters, you can ensure that only
      necessary access is granted and logged.
  - field_paths:
    - admin_info.isAdmin
    - admin_info.isDelegatedAdmin
    - organizational_info.orgUnitPath
    - security_info.isEnforcedIn2Sv
    - security_info.isEnrolledIn2Sv
    literature: The Google UserResource represents a user account within the Google
      Workspace environment. Enforcing the principle of least privilege for this resource
      involves ensuring that user accounts are granted only the necessary permissions
      and access rights to perform their authorized tasks, and no more. This can be
      achieved by implementing role-based access control (RBAC) and granular permission
      management within the Google Workspace Admin console.
    name: UserResource
    reason: The UserResource contains fields that can be used to manage user privileges,
      roles, and access controls within the Google Workspace environment, making it
      applicable for implementing the principle of least privilege.
