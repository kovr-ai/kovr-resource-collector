check:
  category: encryption
  control_names:
  - NIST-800-53-SC-12
  - NIST-800-53-SC-13
  - ISO-27001-A.10.1.2
  literature: Secure key management is a critical aspect of ensuring the confidentiality,
    integrity, and availability of sensitive data. Keys are used to encrypt and decrypt
    data, authenticate users and systems, and ensure the integrity of data transmissions.
    Improper key management can lead to unauthorized access, data breaches, and other
    security incidents. This check validates that an application or system implements
    secure key management practices, such as using strong encryption algorithms, properly
    generating and storing keys, regularly rotating keys, and securely distributing
    keys to authorized parties. Failure to implement secure key management can result
    in data exposure, unauthorized access, and other security risks.
  name: owasp-latest-implement-secure-key-management
  resource:
    field_paths: []
    literature: null
    name: IAMResource
    reason: null
  unique_id: owasp-latest-implement-secure-key-management
errors:
- error: "Traceback (most recent call last):\n  File \"/Users/aetoskia/Workspace/code/kovr-resource-collector/llm_generator/checks_with_python_logic/validate_with_mock_data/services.py\"\
    , line 72, in _process_input\n    comparison_operation = get_comparison_operation(input_resource.logic)\n\
    \  File \"/Users/aetoskia/Workspace/code/kovr-resource-collector/llm_generator/checks_with_python_logic/validate_with_mock_data/services.py\"\
    , line 24, in get_comparison_operation\n    function = ComparisonOperation.get_custom_function(\n\
    \        operation_enum,\n        logic\n    )\n  File \"/Users/aetoskia/Workspace/code/kovr-resource-collector/con_mon/compliance/models/checks.py\"\
    , line 169, in get_custom_function\n    exec(get_function_code, safe_globals,\
    \ local_ns)\n    ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"<string>\"\
    , line 15\n    for user in fetched_value:\n                              ^\nIndentationError:\
    \ unindent does not match any outer indentation level\n"
  field_path: users[].access_keys[].status
  input_filepath: llm_generator_v2/data/debugging/sec3_checks_with_python_logic/step1_generate_python_logic/input/owasp-latest-implement-secure-key-management-IAMResource.yaml
  logic: "result = True\n\nif fetched_value is None:\n    result = False\nelse:\n\
    \    for access_key_status in fetched_value:\n        if access_key_status ==\
    \ 'Active':\n            # Check if the access key is older than 90 days\n   \
    \                     now = datetime.datetime.utcnow()\n            for user in\
    \ fetched_value:\n                for access_key in user.access_keys:\n      \
    \              if access_key.status == 'Active':\n                        create_date\
    \ = access_key.create_date\n                        age = now - create_date\n\
    \                        if age.days > 90:\n                            result\
    \ = False\n                            break\n        else:\n            result\
    \ = False\n            break"
  output_filepath: llm_generator_v2/data/debugging/sec3_checks_with_python_logic/step1_generate_python_logic/output/owasp-latest-implement-secure-key-management-IAMResource.yaml
  result: null
  success: false
