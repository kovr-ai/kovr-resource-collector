check:
  category: access_control
  control_names:
  - NIST-800-53-AC-6
  - ISO-27001-A.9.1.1
  literature: The 'owasp-latest-enforce-least-privileges' check validates that applications
    and systems follow the principle of least privilege, which is a fundamental security
    concept that restricts access rights for users, accounts, and processes to only
    those permissions that are essential for performing their intended functions.
    Granting excessive privileges increases the potential attack surface and risk
    of unauthorized access or misuse. This check helps mitigate threats like privilege
    escalation, unauthorized data access, and malicious code execution by ensuring
    that entities operate with the minimum necessary permissions.
  resource:
    field_paths:
    - policies
    - policies[].default_version.Document.Statement
    - policies[].default_version.Document.Statement[].Action
    - policies[].default_version.Document.Statement[].Resource
    - users
    - users[].access_keys
    - users[].mfa_devices
    literature: The AWS IAM resource is highly relevant for implementing the 'owasp-latest-enforce-least-privileges'
      security check. IAM policies define the permissions granted to IAM users, groups,
      and roles, allowing you to enforce the principle of least privilege. By analyzing
      the policy documents and attached entities, you can verify if excessive privileges
      have been granted.
    name: IAMResource
    reason: The IAM resource contains crucial information about the permissions granted
      to users and roles through policies, as well as details on user access keys
      and multi-factor authentication (MFA) devices. This data is essential for assessing
      if the least privilege principle is being followed.
  unique_id: owasp-latest-enforce-least-privileges
errors:
- error: "Traceback (most recent call last):\n  File \"/Users/aetoskia/Workspace/code/kovr-resource-collector/llm_generator/checks_with_python_logic/validate_with_mock_data/services.py\"\
    , line 73, in _process_input\n    result = comparison_operation(fetched_value,\
    \ None)\n  File \"/Users/aetoskia/Workspace/code/kovr-resource-collector/con_mon/compliance/models/checks.py\"\
    , line 39, in __call__\n    response = self.function(fetched_value, config_value)\n\
    \  File \"<string>\", line 22, in custom\n  File \"<string>\", line 12, in custom\n\
    AttributeError: 'NoneType' object has no attribute 'block_public_acls'\n"
  input_filepath: llm_generator/data/debugging/sec3_checks_with_python_logic/step1_generate_python_logic/input/owasp-latest-enforce-least-privileges-S3Resource.yaml
  output_filepath: llm_generator/data/debugging/sec3_checks_with_python_logic/step1_generate_python_logic/output/owasp-latest-enforce-least-privileges-S3Resource.yaml
  result: null
  success: false
