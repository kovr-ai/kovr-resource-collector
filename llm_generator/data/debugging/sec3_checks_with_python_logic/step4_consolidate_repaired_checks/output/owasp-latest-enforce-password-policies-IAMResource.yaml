check:
  name: owasp-latest-enforce-password-policies
  resource:
    field_path: policies[].default_version.Document.Statement
    fix_details:
      automation_available: true
      description: If the IAM password policies do not meet the required standards,
        they need to be updated or created to enforce strong password requirements.
      estimated_time: 30 minutes to 1 hour
      instructions:
      - Review the existing IAM password policies and identify any missing or inadequate
        requirements.
      - Create a new IAM password policy or update the existing one to include the
        necessary requirements, such as minimum password length, complexity rules,
        expiration periods, and restrictions on password reuse.
      - Attach the updated or new IAM password policy to the relevant IAM users or
        groups.
      - Communicate the new password policy requirements to users and provide guidance
        on updating their passwords accordingly.
    logic: "result = False\n\nif fetched_value is None:\n    result = False\nelse:\n\
      \    for statement in fetched_value:\n        if hasattr(statement, 'Effect')\
      \ and statement.Effect == 'Allow':\n            condition = getattr(statement,\
      \ 'Condition', None)\n            if condition:\n                if 'PasswordPolicy'\
      \ in condition:\n                    password_policy = condition['PasswordPolicy']\n\
      \                    min_length = password_policy.get('MinimumPasswordLength',\
      \ 0)\n                    require_symbols = password_policy.get('RequireSymbols',\
      \ False)\n                    require_numbers = password_policy.get('RequireNumbers',\
      \ False)\n                    require_uppercase = password_policy.get('RequireUppercaseCharacters',\
      \ False)\n                    require_lowercase = password_policy.get('RequireLowercaseCharacters',\
      \ False)\n                    max_age = password_policy.get('MaxPasswordAge',\
      \ 0)\n                    password_reuse_prevention = password_policy.get('PasswordReusePrevention',\
      \ 0)\n                    if min_length >= 8 and require_symbols and require_numbers\
      \ and require_uppercase and require_lowercase and max_age <= 90 and password_reuse_prevention\
      \ >= 24:\n                        result = True\n                        break"
    name: IAMResource
    output_statements:
      failure: The IAM password policies do not enforce strong password requirements,
        leaving the system vulnerable to weak or easily guessable passwords.
      partial: The IAM password policies partially enforce strong password requirements,
        but some critical aspects are missing or not properly configured.
      success: The IAM password policies enforce strong password requirements, including
        minimum length, complexity rules, expiration periods, and restrictions on
        password reuse.
  unique_id: owasp-latest-enforce-password-policies
