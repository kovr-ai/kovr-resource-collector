check:
  name: owasp-latest-implement-password-strength-requirements
  resource:
    field_path: policies[].default_version.Document.Statement
    fix_details:
      automation_available: true
      description: If IAM password policies do not meet the OWASP requirements, they
        need to be updated to enforce stronger password complexity rules.
      estimated_time: 30 minutes to 1 hour
      instructions:
      - Review the current IAM password policy and identify areas that do not comply
        with OWASP recommendations.
      - Update the IAM password policy to include requirements for minimum password
        length, complexity rules (e.g., a mix of uppercase, lowercase, numbers, and
        special characters), and regular password expiration/rotation.
      - Communicate the updated password policy to all IAM users and provide guidance
        on creating compliant passwords.
      - Monitor and enforce the new password policy to ensure ongoing compliance.
    logic: "result = False\n\nif fetched_value is None:\n    result = False\nelse:\n\
      \    for statement in fetched_value:\n        if hasattr(statement, 'Effect')\
      \ and statement.Effect == 'Allow':\n            condition = getattr(statement,\
      \ 'Condition', None)\n            if condition:\n                if 'PasswordPolicy'\
      \ in condition:\n                    password_policy = condition['PasswordPolicy']\n\
      \                    min_length = password_policy.get('MinimumPasswordLength',\
      \ 0)\n                    require_numbers = password_policy.get('RequireNumbers',\
      \ False)\n                    require_symbols = password_policy.get('RequireSymbols',\
      \ False)\n                    require_uppercase = password_policy.get('RequireUppercaseCharacters',\
      \ False)\n                    require_lowercase = password_policy.get('RequireLowercaseCharacters',\
      \ False)\n                    if min_length >= 12 and require_numbers and require_symbols\
      \ and require_uppercase and require_lowercase:\n                        result\
      \ = True\n                        break"
    name: IAMResource
    output_statements:
      failure: IAM password policies do not meet the latest OWASP password strength
        requirements. Weak password policies increase the risk of unauthorized access.
      partial: Some IAM password policies meet the OWASP requirements, but others
        do not. Inconsistent password strength increases the risk of unauthorized
        access.
      success: IAM password policies are configured to meet or exceed the latest OWASP
        password strength requirements.
  unique_id: owasp-latest-implement-password-strength-requirements
