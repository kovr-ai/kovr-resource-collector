check:
  name: owasp-latest-validate-access-controls-on-the-server-side
  resource:
    field_path: trails[*].event_selectors[*].data_resources.values[*]
    fix_details:
      automation_available: true
      description: If CloudTrail trails and event selectors are not properly configured
        to capture and analyze access control-related events, remediation steps are
        required.
      estimated_time: 30 minutes to 1 hour
      instructions:
      - Review the existing CloudTrail trails and event selectors to identify any
        gaps in capturing access control-related events.
      - Configure event selectors to include relevant data resources and management
        events related to access control.
      - Ensure that the read_write_type parameter is set to capture both read and
        write events.
      - Enable log file validation and configure appropriate log retention policies.
      - Set up monitoring and alerting mechanisms to detect and respond to potential
        access control violations.
    logic: "result = False\n\nif fetched_value is None:\n    result = False\nelse:\n\
      \    for values_list in fetched_value:\n        if 'arn:aws:s3:::' in values_list:\n\
      \            result = True\n            break"
    name: CloudTrailResource
    output_statements:
      failure: CloudTrail trails and event selectors are not configured to capture
        and analyze access control-related events, preventing proper validation of
        server-side access controls.
      partial: CloudTrail trails and event selectors are partially configured to capture
        and analyze access control-related events, but additional configuration may
        be required for comprehensive validation of server-side access controls.
      success: CloudTrail trails and event selectors are configured to capture and
        analyze access control-related events, allowing for proper validation of server-side
        access controls.
  unique_id: owasp-latest-validate-access-controls-on-the-server-side
