check:
  unique_id: owasp-latest-implement-secure-deployment-processes
resource:
  field_path: policies[].default_version.Document.Statement[].Action
  logic: "result = False\n\nif fetched_value is None:\n    result = False\nelse:\n\
    \    secure_deployment_actions = ['iam:PassRole', 'iam:AddUserToGroup', 'iam:CreateAccessKey',\
    \ 'iam:UpdateAccessKey', 'iam:DeleteAccessKey', 'iam:EnableMFADevice', 'iam:ResyncMFADevice']\n\
    \    for action in fetched_value:\n        if isinstance(action, str) and action\
    \ in secure_deployment_actions:\n            result = True\n            break"
  name: IAMResource
