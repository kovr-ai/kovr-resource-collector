check:
  unique_id: owasp-latest-enforce-password-policies
resource:
  field_path: policies[].default_version.Document.Statement
  logic: "result = False\n\nif fetched_value is None:\n    result = False\nelse:\n\
    \    for statement in fetched_value:\n        if hasattr(statement, 'Effect')\
    \ and statement.Effect == 'Allow':\n            condition = getattr(statement,\
    \ 'Condition', None)\n            if condition:\n                if 'PasswordPolicy'\
    \ in condition:\n                    password_policy = condition['PasswordPolicy']\n\
    \                    min_length = password_policy.get('MinimumPasswordLength',\
    \ 0)\n                    require_symbols = password_policy.get('RequireSymbols',\
    \ False)\n                    require_numbers = password_policy.get('RequireNumbers',\
    \ False)\n                    require_uppercase = password_policy.get('RequireUppercaseCharacters',\
    \ False)\n                    require_lowercase = password_policy.get('RequireLowercaseCharacters',\
    \ False)\n                    max_age = password_policy.get('MaxPasswordAge',\
    \ 0)\n                    password_reuse_prevention = password_policy.get('PasswordReusePrevention',\
    \ 0)\n                    if min_length >= 8 and require_symbols and require_numbers\
    \ and require_uppercase and require_lowercase and max_age <= 90 and password_reuse_prevention\
    \ >= 24:\n                        result = True\n                        break"
  name: IAMResource
