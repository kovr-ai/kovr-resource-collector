check:
  unique_id: owasp-latest-implement-role-based-access-control-(rbac)
resource:
  field_path: policies[].default_version.Document.Statement
  logic: "result = False\n\nif fetched_value is None:\n    result = False\nelse:\n\
    \    for statement in fetched_value:\n        if hasattr(statement, 'Effect')\
    \ and statement.Effect == 'Allow':\n            if hasattr(statement, 'Action')\
    \ and 'iam:*' in statement.Action:\n                if hasattr(statement, 'Resource')\
    \ and '*' in statement.Resource:\n                    result = False\n       \
    \             break\n            elif hasattr(statement, 'NotAction') and 'iam:*'\
    \ not in statement.NotAction:\n                if hasattr(statement, 'Resource')\
    \ and '*' in statement.Resource:\n                    result = False\n       \
    \             break\n        elif isinstance(statement, dict):\n            if\
    \ statement.get('Effect') == 'Allow':\n                if 'iam:*' in statement.get('Action',\
    \ []):\n                    if '*' in statement.get('Resource', []):\n       \
    \                 result = False\n                        break\n            \
    \    elif 'iam:*' not in statement.get('NotAction', []):\n                   \
    \ if '*' in statement.get('Resource', []):\n                        result = False\n\
    \                        break\n    else:\n        result = True"
  name: IAMResource
