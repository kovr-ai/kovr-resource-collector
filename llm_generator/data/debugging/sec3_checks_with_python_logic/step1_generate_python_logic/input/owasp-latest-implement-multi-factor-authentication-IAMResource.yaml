check:
  category: authentication
  control_names:
  - NIST-800-53-IA-2
  - ISO-27001-A.9.4.2
  literature: Multi-factor authentication (MFA) is a security mechanism that requires
    users to provide two or more forms of authentication to verify their identity
    before granting access to a system, application, or resource. This check validates
    that MFA is implemented and enforced for all user accounts, ensuring an additional
    layer of security beyond just a password. MFA significantly reduces the risk of
    unauthorized access, even if one factor (e.g., a password) is compromised. It
    is an essential security control to protect against various attack vectors, such
    as brute-force attacks, credential stuffing, and phishing attempts.
  name: owasp-latest-implement-multi-factor-authentication
  resource:
    field_paths:
    - users
    - users[]
    - users[].mfa_devices
    - users[].mfa_devices[]
    - users[].mfa_devices[].enable_date
    - users[].mfa_devices[].serial_number
    - users[].mfa_devices[].type
    - users[].mfa_devices[].virtual_mfa_token
    literature: The IAMResource in AWS is applicable for implementing multi-factor
      authentication (MFA) as it contains information about IAM users and their associated
      MFA devices. By analyzing the 'users' and 'users[].mfa_devices' field paths,
      you can determine which users have MFA enabled and enforce MFA for all user
      accounts.
    name: IAMResource
    reason: The IAMResource contains the necessary information to identify IAM users
      and their associated MFA devices, which is essential for implementing and enforcing
      multi-factor authentication.
  unique_id: owasp-latest-implement-multi-factor-authentication
