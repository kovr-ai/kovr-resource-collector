check:
  unique_id: "OWASP-2021-A01-001"
  resource:
    field_path: "repo.basic_info.branches[]"
    logic: |
      def check_branch_protection(fetched_value):
          """
          Check if main/master branches have branch protection enabled
          
          Args:
              repo: Dictionary containing repository data
              
          Returns:
              bool: True if passed, False if failed
          """
          main_branches = ["main", "master"]
          
          for branch in fetched_value:
              branch_name = branch.get("name", "").lower()
              if branch_name in main_branches:
                  if not branch.get("protected", False):
                      return False
                      
          # If we get here, all main branches are protected
          return True
