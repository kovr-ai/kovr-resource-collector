check:
  unique_id: "OWASP-2021-A01-001"
  name: "Branch protection enabled"
  literature: "Verify that GitHub repositories have branch protection enabled on main branches by checking the 'protected' field is set to true for branches named 'main' or 'master'"
  category: "access_control"
  control_names:
    - "NIST-800-53-AC-3"
    - "ISO-27001-A.9.4.1"
  resource:
    name: "GitHub::Repo"
    literature: "Verify that GitHub repositories have branch protection enabled on main branches"
    field_paths:
      - "repo.basic_info.branches[].protected"
    reason: "GitHub::Repo resource contains branch protection information in the branches array"
