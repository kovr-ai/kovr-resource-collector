resource:
  check:
    unique_id: owasp-latest-implement-comprehensive-logging-mechanisms
  field_paths:
  - event_selectors
  - event_selectors[]
  - event_selectors[].data_resources
  - event_selectors[].data_resources.type
  - event_selectors[].data_resources.values
  - event_selectors[].data_resources.values[]
  - event_selectors[].include_management_events
  - event_selectors[].read_write_type
  - trails
  - trails[]
  - trails[].enable_log_file_validation
  - trails[].event_selectors
  - trails[].event_selectors[]
  - trails[].event_selectors[].data_resources
  - trails[].event_selectors[].data_resources.type
  - trails[].event_selectors[].data_resources.values
  - trails[].event_selectors[].data_resources.values[]
  - trails[].event_selectors[].include_management_events
  - trails[].event_selectors[].read_write_type
  - trails[].include_global_service_events
  - trails[].is_logging
  - trails[].is_multi_region_trail
  - trails[].log_file_validation_enabled
  - trails[].s3_bucket_name
  - trails[].s3_key_prefix
  fix_details:
    automation_available: true
    description: 'If CloudTrail is not configured with comprehensive logging mechanisms,
      the following steps can be taken to remediate the issue:'
    estimated_time: 30 minutes to 1 hour
    instructions:
    - 1. Review the CloudTrail trail configurations and ensure that appropriate event
      selectors are defined to capture relevant API calls, console actions, and other
      events.
    - 2. Enable log file validation to ensure the integrity and completeness of CloudTrail
      logs.
    - 3. Configure CloudTrail to include management events and global service events
      to capture administrative actions and events from AWS services.
    - 4. Verify that the CloudTrail trail is logging to an S3 bucket with appropriate
      access controls and retention policies.
    - 5. Consider enabling CloudTrail Insights to detect and respond to unusual activity
      patterns.
  is_valid: true
  literature: AWS CloudTrail is a service that enables comprehensive logging of account
    activity across AWS services and resources. It captures API calls, console actions,
    and other events, providing a detailed audit trail for security analysis, resource
    change tracking, and compliance monitoring. By configuring CloudTrail trails with
    appropriate event selectors and log file validation, organizations can implement
    comprehensive logging mechanisms that capture critical system activities, user
    actions, and security-related events.
  name: CloudTrailResource
  output_statements:
    failure: CloudTrail is not configured with comprehensive logging mechanisms, leaving
      system activities and security events unlogged.
    partial: CloudTrail is partially configured with logging mechanisms, but some
      critical system activities or security events may not be captured.
    success: CloudTrail is configured with comprehensive logging mechanisms, capturing
      critical system activities, user actions, and security-related events.
  reason: AWS CloudTrail provides comprehensive logging capabilities that align with
    the security check's requirement for implementing comprehensive logging mechanisms.
    The resource's field paths allow for configuring event selectors, data resources,
    management event inclusion, read/write event types, log file validation, and other
    settings to capture detailed system activities and security-related events.
