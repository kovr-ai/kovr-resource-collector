check:
  resources:
  - field_paths:
    - buckets
    - buckets[].logging_enabled
    - buckets[].name
    is_valid: true
    literature: The AWS S3 resource can be used to implement secure logging mechanisms
      by enabling access logging and server access logging for S3 buckets. Access
      logs provide detailed records of requests made to a bucket, including the requester,
      bucket name, request time, action, response status, and error codes. Server
      access logs provide detailed records about requests that were made to a bucket
      and the response from the server. These logs can be used for security monitoring,
      operational troubleshooting, and compliance purposes.
    name: S3Resource
    reason: The S3 resource provides the necessary configuration options to enable
      access logging and server access logging for S3 buckets, which is a key aspect
      of implementing secure logging mechanisms.
  - field_paths:
    - trails[].enable_log_file_validation
    - trails[].event_selectors
    - trails[].event_selectors[].data_resources
    - trails[].event_selectors[].include_management_events
    - trails[].event_selectors[].read_write_type
    - trails[].is_logging
    - trails[].is_multi_region_trail
    - trails[].kms_key_id
    - trails[].log_file_validation_enabled
    - trails[].s3_bucket_name
    - trails[].s3_key_prefix
    is_valid: true
    literature: AWS CloudTrail is a service that enables secure logging of account
      activity related to actions across the AWS infrastructure. It records API calls
      for AWS services and captures relevant details about each activity, including
      the identity of the API caller, the time of the event, the source IP address,
      and more. CloudTrail logs can be delivered to an Amazon S3 bucket for long-term
      durability and analysis. Implementing CloudTrail with appropriate configurations
      helps meet the secure logging requirements outlined in the OWASP security check.
    name: CloudTrailResource
    reason: AWS CloudTrail provides comprehensive logging capabilities for capturing
      and storing account activity logs, which aligns with the secure logging requirements
      outlined in the OWASP security check. The relevant field paths allow configuring
      CloudTrail to capture desired event types, enable log file validation, encrypt
      logs with KMS, and deliver logs to a secure S3 bucket.
  - field_paths:
    - log_groups
    - log_groups[].arn
    - log_groups[].creation_time
    - log_groups[].id
    - log_groups[].kms_key_id
    - log_groups[].log_group_name
    - log_groups[].metric_filter_count
    - log_groups[].retention_in_days
    - log_groups[].stored_bytes
    - metrics
    - metrics[].dimensions
    - metrics[].dimensions[].Name
    - metrics[].dimensions[].Value
    - metrics[].metric_name
    - metrics[].namespace
    - alarms
    - alarms[].actions_enabled
    - alarms[].alarm_actions
    - alarms[].alarm_actions[]
    - alarms[].alarm_description
    - alarms[].alarm_name
    - alarms[].comparison_operator
    - alarms[].dimensions
    - alarms[].dimensions[].Name
    - alarms[].dimensions[].Value
    - alarms[].evaluation_periods
    - alarms[].insufficient_data_actions
    - alarms[].insufficient_data_actions[]
    - alarms[].metric_name
    - alarms[].namespace
    - alarms[].ok_actions
    - alarms[].ok_actions[]
    - alarms[].period
    - alarms[].state_reason
    - alarms[].state_updated_timestamp
    - alarms[].state_value
    - alarms[].statistic
    - alarms[].threshold
    is_valid: true
    literature: AWS CloudWatch provides logging and monitoring capabilities that can
      be leveraged to implement secure logging mechanisms. CloudWatch Log Groups can
      be used to collect and store log data from various AWS services and applications.
      Log data can be encrypted using AWS Key Management Service (KMS) keys to ensure
      confidentiality. CloudWatch also supports log retention policies to maintain
      an audit trail for a specified duration. Additionally, CloudWatch Metric Filters
      can be used to analyze log data and trigger alarms or actions based on specific
      patterns or conditions, enabling proactive monitoring and incident response.
    name: CloudWatchResource
    reason: AWS CloudWatch provides logging and monitoring capabilities that can be
      used to implement secure logging mechanisms. CloudWatch Log Groups can store
      log data, which can be encrypted and retained for a specified duration. CloudWatch
      Metric Filters and Alarms can be used to analyze log data and trigger actions
      based on specific conditions, enabling proactive monitoring and incident response.
  unique_id: owasp-latest-implement-secure-logging-mechanisms
